{% extends "appR/dashboard_P.html" %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'appR/css/dashboard_home.css' %}">
{% endblock %}

{% block contenido_dashboard %}

<section class="dashboard-content">

    <!-- ================= TARJETAS ================= -->
    <div class="cards">

        <div class="card">
            <h3>Órdenes totales</h3>
            <p class="number">{{ total_orders }}</p>
        </div>

        <div class="card blue">
            <h3>En proceso</h3>
            <p class="number">{{ in_progress }}</p>
        </div>

        <div class="card green">
            <h3>Finalizadas</h3>
            <p class="number">{{ finished_orders }}</p>
        </div>

        <div class="card red">
            <h3>Atrasadas</h3>
            <p class="number">{{ late_orders }}</p>
        </div>

    </div>

    <!-- ================= ÓRDENES ================= -->
    <section class="panel">

        <div class="panel-header">
            <h2>Órdenes recientes</h2>
        </div>

        <div class="table-container">
            <table>

                <thead>
                    <tr>
                        <th>#</th>
                        <th>Cliente</th>
                        <th>Entrega</th>
                        <th>Estado</th>
                        <th>Progreso</th>
                        <th>Acciones</th>
                    </tr>
                </thead>

                <tbody>
                    {% for order in recent_orders %}
                    <tr>
                        <td>#{{ order.id }}</td>
                        <td>{{ order.cliente.nombre }}</td>
                        <td>{{ order.fecha_entrega|date:"d/m/Y" }}</td>
                        <td>{{ order.estado }}</td>

                        <td>
                            <div class="progress">
                                <div class="progress-bar"
                                     style="width: {{ order.progress }}%;">
                                </div>
                            </div>
                            <small>{{ order.progress }}%</small>
                        </td>

                        <td class="acciones">
                            <a href="{% url 'orden_detail' order.id %}" class="btn ver">
                                Ver
                            </a>

                            <a href="{% url 'orden_revision' order.id %}" class="btn revisar">
                                Revisar
                            </a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="6" class="empty">
                            No hay órdenes recientes
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>

            </table>
        </div>
    </section>

    <!-- ================= SERVICIOS ================= -->
    <section class="panel soft">

        <h3>Servicios recientes</h3>

        <ul class="process-list">
            {% for service in recent_services %}
            <li>
                <strong>{{ service.nombre }}</strong><br>

                <small>
                    Orden #{{ service.orden.id }} —
                    <span class="
                        {% if service.estado == 'Pendiente' %}red
                        {% elif service.estado == 'En proceso' %}yellow
                        {% else %}green{% endif %}
                    ">
                        {{ service.estado }}
                    </span>
                </small>
            </li>
            {% empty %}
            <li>No hay servicios registrados</li>
            {% endfor %}
        </ul>

    </section>

</section>

{% endblock %}
